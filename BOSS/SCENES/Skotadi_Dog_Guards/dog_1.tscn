[gd_scene load_steps=18 format=3 uid="uid://dy4k6jkpav2wc"]

[ext_resource type="Script" path="res://BOSS/SCRIPTS/Skotadi_Dog_Guards/dog_1.gd" id="1_67vh7"]
[ext_resource type="Texture2D" uid="uid://dxy08ovsdj3ws" path="res://BOSS/ASSETS/Skotadi_Dog_Guards/dog2_spritesheet.png" id="2_2qql0"]
[ext_resource type="Script" path="res://FMS/BASE/State Machine.gd" id="3_tm80q"]
[ext_resource type="Script" path="res://FMS/STATES/IDLE.gd" id="4_mp1s4"]
[ext_resource type="Script" path="res://FMS/STATES/WANDER.gd" id="5_d2wpj"]
[ext_resource type="Script" path="res://FMS/STATES/CHASE.gd" id="6_po3ia"]
[ext_resource type="Script" path="res://FMS/STATES/ATTACK.gd" id="7_du57o"]

[sub_resource type="Animation" id="Animation_0yks1"]
resource_name = "ATTACK"
length = 0.7
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Dog_2_Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [13, 14, 15, 16, 17, 18, 19, 20]
}

[sub_resource type="Animation" id="Animation_sya6f"]
resource_name = "CHASE"
length = 1.05
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Dog_2_Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.15, 0.3, 0.45, 0.6, 0.75, 0.9, 1.05),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [7, 8, 9, 10, 11, 12, 13, 14]
}

[sub_resource type="Animation" id="Animation_yod42"]
resource_name = "DEATH"
length = 0.45
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Dog_2_Sprite:self_modulate")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.4),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(1, 1, 1, 1), Color(1, 1, 1, 0)]
}

[sub_resource type="Animation" id="Animation_dpl2w"]
resource_name = "IDLE"
length = 0.8
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Dog_2_Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [0, 0, 1, 2, 3, 4, 5, 6]
}

[sub_resource type="Animation" id="Animation_rhfhf"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Dog_2_Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Dog_2_Sprite:self_modulate")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(1, 1, 1, 1)]
}

[sub_resource type="Animation" id="Animation_n84f4"]
resource_name = "WANDER"
length = 0.65
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Dog_2_Sprite:frame")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1, 1, 1),
"update": 1,
"values": [7, 8, 9, 10, 11, 12, 13]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_pey1k"]
_data = {
"ATTACK": SubResource("Animation_0yks1"),
"CHASE": SubResource("Animation_sya6f"),
"DEATH": SubResource("Animation_yod42"),
"IDLE": SubResource("Animation_dpl2w"),
"RESET": SubResource("Animation_rhfhf"),
"WANDER": SubResource("Animation_n84f4")
}

[sub_resource type="RectangleShape2D" id="RectangleShape2D_dsoyr"]
size = Vector2(96, 80)

[sub_resource type="CircleShape2D" id="CircleShape2D_6lgn1"]
radius = 128.996

[sub_resource type="CapsuleShape2D" id="CapsuleShape2D_u4s07"]
radius = 80.0
height = 160.0

[node name="Dog_1" type="CharacterBody2D" node_paths=PackedStringArray("FMS_Dog1") groups=["dog1"]]
collision_layer = 2
collision_mask = 5
script = ExtResource("1_67vh7")
FMS_Dog1 = NodePath("FSM")

[node name="Sprite" type="Node2D" parent="."]
rotation = -1.5708

[node name="Dog_2_Sprite" type="Sprite2D" parent="Sprite"]
texture_filter = 1
texture = ExtResource("2_2qql0")
hframes = 7
vframes = 3

[node name="AnimationPlayer" type="AnimationPlayer" parent="Sprite"]
libraries = {
"": SubResource("AnimationLibrary_pey1k")
}

[node name="Collision" type="CollisionShape2D" parent="."]
light_mask = 2
visibility_layer = 5
shape = SubResource("RectangleShape2D_dsoyr")

[node name="FSM" type="Node2D" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("3_tm80q")
initial_state = NodePath("IDLE")

[node name="IDLE" type="Node2D" parent="FSM" node_paths=PackedStringArray("timer_idle", "player_detector_1", "player_detector_2")]
script = ExtResource("4_mp1s4")
timer_idle = NodePath("../../Timer")
timer_wait_time = 3.0
player_detector_1 = NodePath("../../DetectorY")
player_detector_2 = NodePath("../../Detectorx")
next_state_1 = "wander"
next_state_2 = "chase"

[node name="WANDER" type="Node2D" parent="FSM" node_paths=PackedStringArray("timer_wander", "Points", "next_point", "Navigator", "player_detector_1", "player_detector_2")]
script = ExtResource("5_d2wpj")
timer_wander = NodePath("../../Timer")
wander_speed = 100.0
Points = NodePath("../../Points")
next_point = NodePath("../../Timer_Wander_Points")
Navigator = NodePath("../../Dog_1_nav")
player_detector_1 = NodePath("../../DetectorY")
player_detector_2 = NodePath("../../Detectorx")
timer_wait_time = 7.0
previous_state = "idle"
next_state = "chase"

[node name="CHASE" type="Node2D" parent="FSM" node_paths=PackedStringArray("Navigator", "timer_chase", "player_detector_1", "player_detector_2", "attack_detector")]
script = ExtResource("6_po3ia")
Navigator = NodePath("../../Dog_1_nav")
timer_chase = NodePath("../../Timer")
player_detector_1 = NodePath("../../DetectorY")
player_detector_2 = NodePath("../../Detectorx")
attack_detector = NodePath("../../Attack_Detector")
chase_speed = 125.0
timer_time = 2.5
previous_state = "idle"
next_state = "attack"

[node name="ATTACK" type="Node2D" parent="FSM" node_paths=PackedStringArray("timer_attack_cooldown", "attack_detector", "Navigator")]
script = ExtResource("7_du57o")
timer_attack_cooldown = NodePath("../../Timer")
timer_time = 0.75
attack_detector = NodePath("../../Attack_Detector")
damage = 100.0
chase_speed = 150.0
Navigator = NodePath("../../Dog_1_nav")
previous_state = "idle"

[node name="Timer_Wander_Points" type="Timer" parent="."]
wait_time = 2.0
autostart = true

[node name="Timer" type="Timer" parent="."]
wait_time = 2.0
autostart = true

[node name="DetectorY" type="RayCast2D" parent="."]
light_mask = 4
target_position = Vector2(0, 400)

[node name="Detectorx" type="RayCast2D" parent="."]
light_mask = 4
target_position = Vector2(0, 400)

[node name="Attack_Detector" type="Area2D" parent="."]
collision_layer = 2
collision_mask = 3

[node name="CollisionShape2D" type="CollisionShape2D" parent="Attack_Detector"]
shape = SubResource("CircleShape2D_6lgn1")

[node name="Hit_Detector" type="Area2D" parent="."]

[node name="CollisionShape2D" type="CollisionShape2D" parent="Hit_Detector"]
shape = SubResource("CapsuleShape2D_u4s07")

[node name="Points" type="Node2D" parent="."]

[node name="Marker2D" type="Marker2D" parent="Points"]
position = Vector2(64, 64)

[node name="Marker2D2" type="Marker2D" parent="Points"]
position = Vector2(-64, -64)

[node name="Marker2D3" type="Marker2D" parent="Points"]
position = Vector2(-64, 64)

[node name="Marker2D4" type="Marker2D" parent="Points"]
position = Vector2(64, -64)

[node name="Dog_1_nav" type="NavigationAgent2D" parent="."]
path_desired_distance = 5.0

[node name="ProgressBar" type="ProgressBar" parent="."]
offset_left = -96.0
offset_top = 96.0
offset_right = 104.0
offset_bottom = 123.0
max_value = 1000.0
value = 1000.0

[connection signal="area_entered" from="Hit_Detector" to="." method="_on_hit_detector_area_entered"]
